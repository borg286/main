apiVersion: helm.toolkit.fluxcd.io/v2
kind: HelmRelease
metadata:
  name: kong
  namespace: flux-system
spec:
  interval: 5m
  targetNamespace: kong
  install:
    createNamespace: true
  chart:
    spec:
      chart: kong
      version: "3.0.1"
      sourceRef:
        kind: HelmRepository
        name: kong
        namespace: flux-system
  values:
    ingressController:
      ingressClassAnnotations:
        ingressclass.kubernetes.io/is-default-class: "true"
      enabled: true
      installCRDs: false
      args:
        - "--publish-status-address=50.47.202.155"
    proxy:
      http:
        enabled: true
        servicePort: 80
        containerPort: 8000
        nodePort: 30300
      tls:
        enabled: true
        servicePort: 443
        containerPort: 8443
        nodePort: 32084
    env:
      database: "off"  # Use DB-less mode for simplicity
    serviceMonitor:
      enabled: true  # Optional: Enable if using Prometheus
